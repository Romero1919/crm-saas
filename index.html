<!DOCTYPE html>
<html>
<head>
<title>CRM SaaS</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>

body{
font-family:Arial;
padding:20px;
background:#f2f2f2;
}

.card{
background:white;
padding:20px;
margin-bottom:20px;
border-radius:10px;
}

#crm{
display:none;
}

</style>

</head>

<body>

<div class="card" id="auth">

<h2>Crear cuenta</h2>

<input id="email" placeholder="correo">

<input id="password" type="password" placeholder="password">

<br><br>

<button onclick="signup()">Crear cuenta</button>

<button onclick="login()">Ingresar</button>

</div>

<div id="crm" class="card">

<h2>CRM PRIVADO</h2>

<input id="cliente" placeholder="nombre cliente">

<button onclick="guardar()">Guardar cliente</button>

<ul id="lista"></ul>

<button onclick="logout()">Cerrar sesi√≥n</button>

</div>

<script>

const SUPABASE_URL="AQUI TU URL";

const SUPABASE_KEY="AQUI TU API KEY";

const supabase=window.supabase.createClient(
SUPABASE_URL,
SUPABASE_KEY
);

check();

async function check(){

const {data:{session}}=
await supabase.auth.getSession();

if(session){

mostrarCRM();

}

}

function mostrarCRM(){

document.getElementById("auth").style.display="none";

document.getElementById("crm").style.display="block";

cargar();

}

async function signup(){

const email=
document.getElementById("email").value;

const password=
document.getElementById("password").value;

const {error}=await supabase.auth.signUp({

email,
password

});

if(error){

alert(error.message);

}else{

alert("Cuenta creada revisa correo");

}

}

async function login(){

const email=
document.getElementById("email").value;

const password=
document.getElementById("password").value;

const {error}=await supabase.auth.signInWithPassword({

email,
password

});

if(error){

alert(error.message);

}else{

mostrarCRM();

}

}

async function logout(){

await supabase.auth.signOut();

location.reload();

}

async function guardar(){

const nombre=
document.getElementById("cliente").value;

const user=
await supabase.auth.getUser();

await supabase
.from("clientes")
.insert({

nombre:nombre,
user_id:user.data.user.id

});

cargar();

}

async function cargar(){

const user=
await supabase.auth.getUser();

const {data}=await supabase
.from("clientes")
.select("*")
.eq("user_id",user.data.user.id);

const lista=
document.getElementById("lista");

lista.innerHTML="";

data.forEach(c=>{

lista.innerHTML+=
"<li>"+c.nombre+"</li>";

});

}

</script>

</body>

</html>

